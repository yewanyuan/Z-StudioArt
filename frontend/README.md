# PopGraph Frontend

çˆ†æ¬¾å›¾ - AI å›¾æ–‡ä¸€ä½“åŒ–ç”Ÿæˆå¹³å°å‰ç«¯

## æŠ€æœ¯æ ˆ

- React 19
- TypeScript
- Vite
- TailwindCSS
- Vitest + fast-check (æµ‹è¯•)

## å¼€å‘ç¯å¢ƒè®¾ç½®

### å®‰è£…ä¾èµ–

```bash
cd frontend
npm install
```

### è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

å¼€å‘æœåŠ¡å™¨é»˜è®¤é…ç½®ï¼š
- åœ°å€ï¼š`http://localhost:5173`
- æ”¯æŒå¤–éƒ¨è®¿é—®ï¼š`http://<your-ip>:5173`ï¼ˆå·²é…ç½® `host: '0.0.0.0'`ï¼‰

> å¤–éƒ¨è®¿é—®åŠŸèƒ½ä¾¿äºåœ¨å±€åŸŸç½‘å†…çš„å…¶ä»–è®¾å¤‡ï¼ˆå¦‚æ‰‹æœºï¼‰ä¸Šé¢„è§ˆå’Œæµ‹è¯•ã€‚

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm run test:watch
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

## é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PaymentModal.tsx      # æ”¯ä»˜æ¨¡æ€æ¡†
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.tsx    # è·¯ç”±å®ˆå«
â”‚   â”‚   â””â”€â”€ ...                   # å…¶ä»–ç»„ä»¶
â”‚   â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx         # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ RegisterPage.tsx      # æ³¨å†Œé¡µé¢
â”‚   â”‚   â”œâ”€â”€ HistoryPage.tsx       # å†å²è®°å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ SubscriptionPage.tsx  # è®¢é˜…é¡µé¢
â”‚   â”‚   â””â”€â”€ index.ts              # é¡µé¢å¯¼å‡º
â”‚   â”œâ”€â”€ services/      # API æœåŠ¡
â”‚   â”‚   â””â”€â”€ api.ts     # API å®¢æˆ·ç«¯ï¼ˆå«ç”¨æˆ·èº«ä»½ç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ stores/        # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ authStore.ts  # è®¤è¯çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
â”‚   â”œâ”€â”€ types/         # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ test/          # æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ App.tsx        # ä¸»åº”ç”¨ç»„ä»¶ï¼ˆè·¯ç”±é…ç½®ï¼‰
â”‚   â””â”€â”€ main.tsx       # å…¥å£æ–‡ä»¶
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/          # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ property/      # å±æ€§æµ‹è¯•
â””â”€â”€ package.json
```

## ç±»å‹å®šä¹‰ (`src/types/index.ts`)

å‰ç«¯ç±»å‹å®šä¹‰ä¸åç«¯ `schemas.py` ä¿æŒä¸€è‡´ï¼Œç¡®ä¿å‰åç«¯æ•°æ®ç»“æ„ç»Ÿä¸€ã€‚

### æšä¸¾ç±»å‹

| ç±»å‹ | å¯é€‰å€¼ | è¯´æ˜ |
|------|--------|------|
| `MembershipTier` | `'free'` \| `'basic'` \| `'professional'` | ä¼šå‘˜ç­‰çº§ |
| `TemplateCategory` | `'promotional'` \| `'premium'` \| `'holiday'` | æ¨¡æ¿åˆ†ç±» |
| `HolidayType` | `'spring_festival'` \| `'valentines'` \| `'double_eleven'` | èŠ‚æ—¥ç±»å‹ |
| `AspectRatio` | `'1:1'` \| `'9:16'` \| `'16:9'` | è¾“å‡ºå°ºå¯¸æ¯”ä¾‹ |
| `Language` | `'zh'` \| `'en'` | æ–‡æ¡ˆè¯­è¨€ |

### æµ·æŠ¥ç”Ÿæˆç±»å‹

| æ¥å£ | ç”¨é€” |
|------|------|
| `PosterGenerationRequest` | æµ·æŠ¥ç”Ÿæˆè¯·æ±‚å‚æ•° |
| `GeneratedImage` | ç”Ÿæˆçš„å›¾åƒä¿¡æ¯ï¼ˆå«å¯é€‰ Base64 æ•°æ®ï¼‰ |
| `PosterGenerationResponse` | æµ·æŠ¥ç”Ÿæˆå“åº” |

#### GeneratedImage å­—æ®µ

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `id` | string | æ˜¯ | å›¾åƒå”¯ä¸€æ ‡è¯† |
| `url` | string | æ˜¯ | å›¾åƒ URLï¼ˆæ¨èä½¿ç”¨ï¼‰ |
| `thumbnail_url` | string | æ˜¯ | ç¼©ç•¥å›¾ URL |
| `has_watermark` | boolean | æ˜¯ | æ˜¯å¦æœ‰æ°´å° |
| `width` | number | æ˜¯ | å›¾åƒå®½åº¦ |
| `height` | number | æ˜¯ | å›¾åƒé«˜åº¦ |
| `image_base64` | string | å¦ | å›¾åƒ Base64 ç¼–ç æ•°æ® |

### æ¨¡æ¿ç±»å‹

| æ¥å£ | ç”¨é€” |
|------|------|
| `PromptModifiers` | æ¨¡æ¿ Prompt ä¿®é¥°å‚æ•° |
| `Template` | é¢„è®¾å•†ä¸šæ¨¡æ¿å®šä¹‰ |

### åœºæ™¯èåˆç±»å‹

| æ¥å£ | ç”¨é€” |
|------|------|
| `SceneFusionRequest` | åœºæ™¯èåˆè¯·æ±‚å‚æ•° |
| `SceneFusionResponse` | åœºæ™¯èåˆå“åº” |

### é€šç”¨ç±»å‹

| æ¥å£ | ç”¨é€” |
|------|------|
| `ApiError` | API é”™è¯¯å“åº”æ ¼å¼ |
| `GenerationState` | UI ç”ŸæˆçŠ¶æ€ç®¡ç† |

### è®¤è¯ç±»å‹

| æ¥å£ | ç”¨é€” |
|------|------|
| `User` | ç”¨æˆ·ä¿¡æ¯ |
| `TokenPair` | Token å¯¹ï¼ˆaccess_token + refresh_tokenï¼‰ |
| `AuthState` | è®¤è¯çŠ¶æ€ï¼ˆç”¨äºçŠ¶æ€ç®¡ç†ï¼‰ |
| `SendCodeRequest` | å‘é€éªŒè¯ç è¯·æ±‚ |
| `PhoneLoginRequest` | æ‰‹æœºå·ç™»å½•è¯·æ±‚ |
| `PhoneRegisterRequest` | æ‰‹æœºå·æ³¨å†Œè¯·æ±‚ |
| `EmailLoginRequest` | é‚®ç®±ç™»å½•è¯·æ±‚ |
| `EmailRegisterRequest` | é‚®ç®±æ³¨å†Œè¯·æ±‚ |
| `RefreshTokenRequest` | åˆ·æ–° Token è¯·æ±‚ |
| `TokenResponse` | Token å“åº” |
| `UserResponse` | ç”¨æˆ·ä¿¡æ¯å“åº” |
| `AuthResponse` | è®¤è¯å“åº”ï¼ˆåŒ…å«ç”¨æˆ·ä¿¡æ¯å’Œ Tokenï¼‰ |

### å†å²è®°å½•ç±»å‹

| æ¥å£ | ç”¨é€” | ç›¸å…³éœ€æ±‚ |
|------|------|----------|
| `GenerationType` | ç”Ÿæˆç±»å‹ï¼ˆ`'poster'` \| `'scene_fusion'`ï¼‰ | 6.1 |
| `HistoryItem` | å†å²è®°å½•åˆ—è¡¨é¡¹ | 6.1, 6.3 |
| `HistoryListResponse` | å†å²è®°å½•åˆ—è¡¨å“åº”ï¼ˆå«åˆ†é¡µï¼‰ | 6.3 |
| `HistoryDetailResponse` | å†å²è®°å½•è¯¦æƒ…å“åº” | 6.4 |
| `DeleteHistoryResponse` | åˆ é™¤å†å²è®°å½•å“åº” | 9.1 |

### æ”¯ä»˜ç±»å‹

| æ¥å£ | ç”¨é€” | ç›¸å…³éœ€æ±‚ |
|------|------|----------|
| `PaymentMethod` | æ”¯ä»˜æ–¹å¼ï¼ˆ`'alipay'` \| `'wechat'` \| `'unionpay'`ï¼‰ | 4.2, 4.3, 4.4 |
| `PaymentStatus` | æ”¯ä»˜çŠ¶æ€ï¼ˆ`'pending'` \| `'paid'` \| `'failed'` \| `'expired'` \| `'refunded'`ï¼‰ | 4.9 |
| `SubscriptionPlan` | è®¢é˜…è®¡åˆ’ç±»å‹ | 4.1 |
| `PlanResponse` | è®¢é˜…è®¡åˆ’è¯¦æƒ…å“åº” | 4.1 |
| `PlansListResponse` | è®¡åˆ’åˆ—è¡¨å“åº” | 4.1 |
| `CreateOrderRequest` | åˆ›å»ºè®¢å•è¯·æ±‚ | 4.1 |
| `OrderResponse` | è®¢å•å“åº”ï¼ˆå«æ”¯ä»˜ URL å’ŒäºŒç»´ç ï¼‰ | 4.2, 4.3, 4.4 |
| `OrderStatusResponse` | è®¢å•çŠ¶æ€å“åº” | 4.9 |

#### PlanResponse å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `plan` | SubscriptionPlan | è®¡åˆ’æ ‡è¯† |
| `name` | string | è®¡åˆ’åç§° |
| `price` | number | ä»·æ ¼ï¼ˆåˆ†ï¼‰ |
| `price_display` | string | ä»·æ ¼æ˜¾ç¤ºæ–‡æœ¬ |
| `tier` | MembershipTier | å¯¹åº”ä¼šå‘˜ç­‰çº§ |
| `duration_days` | number | æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰ |
| `description` | string | è®¡åˆ’æè¿° |

#### OrderResponse å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `order_id` | string | è®¢å• ID |
| `user_id` | string | ç”¨æˆ· ID |
| `plan` | SubscriptionPlan | è®¢é˜…è®¡åˆ’ |
| `method` | PaymentMethod | æ”¯ä»˜æ–¹å¼ |
| `amount` | number | é‡‘é¢ï¼ˆåˆ†ï¼‰ |
| `amount_display` | string | é‡‘é¢æ˜¾ç¤ºæ–‡æœ¬ |
| `status` | PaymentStatus | æ”¯ä»˜çŠ¶æ€ |
| `payment_url` | string \| null | æ”¯ä»˜è·³è½¬ URL |
| `qrcode_content` | string \| null | äºŒç»´ç å†…å®¹ |
| `created_at` | string | åˆ›å»ºæ—¶é—´ |
| `expires_in_seconds` | number | å‰©ä½™æœ‰æ•ˆç§’æ•° |

#### HistoryItem å­—æ®µ

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `id` | string | æ˜¯ | è®°å½•å”¯ä¸€æ ‡è¯† |
| `type` | GenerationType | æ˜¯ | ç”Ÿæˆç±»å‹ï¼ˆposter/scene_fusionï¼‰ |
| `thumbnail_url` | string \| null | æ˜¯ | ç¼©ç•¥å›¾ URL |
| `created_at` | string | æ˜¯ | åˆ›å»ºæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰ |
| `input_params` | Record<string, unknown> | æ˜¯ | è¾“å…¥å‚æ•° |
| `output_urls` | string[] | æ˜¯ | è¾“å‡ºå›¾ç‰‡ URL åˆ—è¡¨ |
| `processing_time_ms` | number | æ˜¯ | å¤„ç†æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `has_watermark` | boolean | æ˜¯ | æ˜¯å¦æœ‰æ°´å° |

#### HistoryListResponse å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `items` | HistoryItem[] | å†å²è®°å½•åˆ—è¡¨ |
| `total` | number | æ€»è®°å½•æ•° |
| `page` | number | å½“å‰é¡µç  |
| `page_size` | number | æ¯é¡µæ•°é‡ |
| `has_more` | boolean | æ˜¯å¦æœ‰æ›´å¤šæ•°æ® |

#### User å­—æ®µ

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `id` | string | æ˜¯ | ç”¨æˆ·å”¯ä¸€æ ‡è¯† |
| `phone` | string | å¦ | æ‰‹æœºå·ï¼ˆæ‰‹æœºæ³¨å†Œç”¨æˆ·ï¼‰ |
| `email` | string | å¦ | é‚®ç®±ï¼ˆé‚®ç®±æ³¨å†Œç”¨æˆ·ï¼‰ |
| `membership_tier` | MembershipTier | æ˜¯ | ä¼šå‘˜ç­‰çº§ |
| `membership_expiry` | string | å¦ | ä¼šå‘˜è¿‡æœŸæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰ |

#### AuthState å­—æ®µ

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `user` | User \| null | å½“å‰ç™»å½•ç”¨æˆ· |
| `accessToken` | string \| null | JWT Access Token |
| `refreshToken` | string \| null | JWT Refresh Token |
| `isAuthenticated` | boolean | æ˜¯å¦å·²è®¤è¯ |
| `isLoading` | boolean | æ˜¯å¦æ­£åœ¨åŠ è½½ |

## API æœåŠ¡ (`src/services/api.ts`)

å°è£…ä¸åç«¯çš„ HTTP é€šä¿¡ï¼Œæä¾›ç±»å‹å®‰å…¨çš„ API è°ƒç”¨æ¥å£ã€‚

### ç”¨æˆ·èº«ä»½ç®¡ç†

API æœåŠ¡å†…ç½®ç”¨æˆ·èº«ä»½ç®¡ç†åŠŸèƒ½ï¼Œé€šè¿‡ HTTP è¯·æ±‚å¤´ä¼ é€’ç”¨æˆ·ä¿¡æ¯ï¼š

| è¯·æ±‚å¤´ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `X-User-Id` | ç”¨æˆ· ID | `demo-user` |
| `X-User-Tier` | ä¼šå‘˜ç­‰çº§ | `basic` |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```typescript
import { apiService } from './services/api';

// è®¾ç½®ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å½•åè°ƒç”¨ï¼‰
apiService.setUser('user-123', 'professional');

// åç»­ API è°ƒç”¨ä¼šè‡ªåŠ¨æºå¸¦ç”¨æˆ·ä¿¡æ¯
const response = await apiService.generatePoster({
  scene_description: 'å¤æ—¥æµ·æ»©ä¿ƒé”€',
  marketing_text: 'é™æ—¶ç‰¹æƒ ',
  language: 'zh',
  aspect_ratio: '1:1',
});
```

### API æ–¹æ³•

| æ–¹æ³• | åŠŸèƒ½ | å¯¹åº”éœ€æ±‚ |
|------|------|----------|
| `setUser(userId, tier)` | è®¾ç½®ç”¨æˆ·èº«ä»½ä¿¡æ¯ | 7.1, 7.2, 7.3 |
| `generatePoster(request)` | ç”Ÿæˆå•†ä¸šæµ·æŠ¥ | 1.1, 1.2, 2.1, 2.2 |
| `getTemplates(category?)` | è·å–æ¨¡æ¿åˆ—è¡¨ | 3.1, 3.2, 3.3 |
| `sceneFusion(request)` | å•†å“å›¾åœºæ™¯èåˆ | 4.1, 4.2, 4.3 |
| `uploadProductImage(file)` | ä¸Šä¼ å•†å“å›¾ç‰‡ | 4.1 |

### é…ç½®

| ç¯å¢ƒå˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|----------|------|--------|
| `VITE_API_BASE_URL` | åç«¯ API åœ°å€ | `http://localhost:8000` |

### è¶…æ—¶é…ç½®

API å®¢æˆ·ç«¯é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º **180 ç§’ï¼ˆ3 åˆ†é’Ÿï¼‰**ï¼Œä»¥æ”¯æŒæ‰¹é‡å›¾åƒç”Ÿæˆç­‰è€—æ—¶è¾ƒé•¿çš„æ“ä½œã€‚

| æ“ä½œç±»å‹ | è¶…æ—¶æ—¶é—´ | è¯´æ˜ |
|----------|----------|------|
| æ‰€æœ‰è¯·æ±‚ | 180 ç§’ | æ‰¹é‡ç”Ÿæˆï¼ˆ4 å¼ é¢„è§ˆå›¾ï¼‰å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ |

> **æ³¨æ„**ï¼šå¦‚æœé‡åˆ°è¶…æ—¶é”™è¯¯ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œæˆ–ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®šã€‚

## è·¯ç”±é…ç½®

åº”ç”¨ä½¿ç”¨ React Router v6 è¿›è¡Œè·¯ç”±ç®¡ç†ï¼Œè·¯ç”±é…ç½®åœ¨ `App.tsx` ä¸­å®šä¹‰ã€‚

### è·¯ç”±åˆ—è¡¨

| è·¯å¾„ | ç»„ä»¶ | ç±»å‹ | è¯´æ˜ |
|------|------|------|------|
| `/login` | `LoginPage` | å…¬å¼€è·¯ç”± | ç™»å½•é¡µé¢ï¼Œå·²ç™»å½•ç”¨æˆ·è‡ªåŠ¨è·³è½¬é¦–é¡µ |
| `/register` | `RegisterPage` | å…¬å¼€è·¯ç”± | æ³¨å†Œé¡µé¢ï¼Œå·²ç™»å½•ç”¨æˆ·è‡ªåŠ¨è·³è½¬é¦–é¡µ |
| `/` | `MainPage` | å—ä¿æŠ¤è·¯ç”± | ä¸»é¡µé¢ï¼ˆæµ·æŠ¥ç”Ÿæˆã€åœºæ™¯èåˆï¼‰ |
| `/history` | `HistoryPage` | å—ä¿æŠ¤è·¯ç”± | ç”Ÿæˆå†å²è®°å½•é¡µé¢ |
| `/subscription` | `SubscriptionPage` | å—ä¿æŠ¤è·¯ç”± | ä¼šå‘˜è®¢é˜…é¡µé¢ |
| `*` | `MainPage` | å—ä¿æŠ¤è·¯ç”± | å…¶ä»–è·¯ç”±é‡å®šå‘åˆ°é¦–é¡µ |

### è·¯ç”±å®ˆå«

| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| `ProtectedRoute` | å—ä¿æŠ¤è·¯ç”±ï¼Œæœªç™»å½•ç”¨æˆ·é‡å®šå‘åˆ° `/login` |
| `PublicRoute` | å…¬å¼€è·¯ç”±ï¼Œå·²ç™»å½•ç”¨æˆ·é‡å®šå‘åˆ° `/` |

### ä¸»é¡µé¢å¯¼èˆª

ä¸»é¡µé¢ (`MainPage`) åŒ…å«åº•éƒ¨å¯¼èˆªæ ï¼Œæ”¯æŒåœ¨ä»¥ä¸‹åŠŸèƒ½é—´åˆ‡æ¢ï¼š

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| ğŸ¨ æµ·æŠ¥ç”Ÿæˆ | AI å•†ä¸šæµ·æŠ¥ç”Ÿæˆ |
| ğŸ–¼ï¸ åœºæ™¯èåˆ | å•†å“å›¾åœºæ™¯èåˆ |

### ç”¨æˆ·ä¿¡æ¯æ 

ä¸»é¡µé¢å³ä¸Šè§’æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯æ ï¼ŒåŒ…å«ï¼š

| å…ƒç´  | è¯´æ˜ |
|------|------|
| ç”¨æˆ·æ ‡è¯† | æ˜¾ç¤ºæ‰‹æœºå·æˆ–é‚®ç®± |
| ä¼šå‘˜ç­‰çº§å¾½ç«  | ç‚¹å‡»è·³è½¬è®¢é˜…é¡µé¢ |
| ğŸ“œ å†å²è®°å½• | è·³è½¬å†å²è®°å½•é¡µé¢ |
| ğŸ‘‘ ä¼šå‘˜è®¢é˜… | è·³è½¬è®¢é˜…é¡µé¢ |
| é€€å‡º | ç™»å‡ºå½“å‰ç”¨æˆ· |

## é¡µé¢ç»„ä»¶

### RegisterPage (`src/pages/RegisterPage.tsx`)

ç”¨æˆ·æ³¨å†Œé¡µé¢ï¼Œæ”¯æŒæ‰‹æœºéªŒè¯ç æ³¨å†Œå’Œé‚®ç®±å¯†ç æ³¨å†Œä¸¤ç§æ–¹å¼ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

| åŠŸèƒ½ | è¯´æ˜ | ç›¸å…³éœ€æ±‚ |
|------|------|----------|
| æ‰‹æœºå·æ³¨å†Œ | è¾“å…¥æ‰‹æœºå· + éªŒè¯ç å®Œæˆæ³¨å†Œ | 8.1, 8.2 |
| é‚®ç®±æ³¨å†Œ | è¾“å…¥é‚®ç®± + å¯†ç å®Œæˆæ³¨å†Œ | 8.3, 8.4 |
| éªŒè¯ç å€’è®¡æ—¶ | 60 ç§’å‘é€é—´éš”é™åˆ¶ | 8.2 |
| è¡¨å•éªŒè¯ | å®æ—¶éªŒè¯è¾“å…¥æ ¼å¼ | 8.5 |
| è‡ªåŠ¨ç™»å½• | æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨ç™»å½•å¹¶è·³è½¬ | 8.6 |
| ç™»å½•çŠ¶æ€æ£€æµ‹ | å·²ç™»å½•ç”¨æˆ·è‡ªåŠ¨è·³è½¬é¦–é¡µ | 8.7 |

**éªŒè¯è§„åˆ™ï¼š**

| å­—æ®µ | è§„åˆ™ |
|------|------|
| æ‰‹æœºå· | ä¸­å›½å¤§é™†æ‰‹æœºå·æ ¼å¼ (`1[3-9]\d{9}`) |
| éªŒè¯ç  | 6 ä½æ•°å­— |
| é‚®ç®± | æ ‡å‡†é‚®ç®±æ ¼å¼ |
| å¯†ç  | è‡³å°‘ 8 ä¸ªå­—ç¬¦ |
| ç¡®è®¤å¯†ç  | å¿…é¡»ä¸å¯†ç ä¸€è‡´ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```typescript
// åœ¨ App.tsx ä¸­é…ç½®è·¯ç”±
import { RegisterPage } from './pages';

<Route path="/register" element={<RegisterPage />} />
```

### LoginPage (`src/pages/LoginPage.tsx`)

ç”¨æˆ·ç™»å½•é¡µé¢ï¼Œæ”¯æŒæ‰‹æœºéªŒè¯ç ç™»å½•å’Œé‚®ç®±å¯†ç ç™»å½•ä¸¤ç§æ–¹å¼ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| æ‰‹æœºå·ç™»å½• | è¾“å…¥æ‰‹æœºå· + éªŒè¯ç å®Œæˆç™»å½• |
| é‚®ç®±ç™»å½• | è¾“å…¥é‚®ç®± + å¯†ç å®Œæˆç™»å½• |
| éªŒè¯ç å€’è®¡æ—¶ | 60 ç§’å‘é€é—´éš”é™åˆ¶ |
| è¡¨å•éªŒè¯ | å®æ—¶éªŒè¯è¾“å…¥æ ¼å¼ |
| ç™»å½•çŠ¶æ€æ£€æµ‹ | å·²ç™»å½•ç”¨æˆ·è‡ªåŠ¨è·³è½¬é¦–é¡µ |

### SubscriptionPage (`src/pages/SubscriptionPage.tsx`)

ä¼šå‘˜è®¢é˜…é¡µé¢ï¼Œå±•ç¤ºè®¢é˜…è®¡åˆ’åˆ—è¡¨å’Œå½“å‰ä¼šå‘˜çŠ¶æ€ï¼Œæ”¯æŒé€‰æ‹©è®¡åˆ’å¹¶å‘èµ·æ”¯ä»˜ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

| åŠŸèƒ½ | è¯´æ˜ | ç›¸å…³éœ€æ±‚ |
|------|------|----------|
| è®¡åˆ’åˆ—è¡¨å±•ç¤º | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„è®¢é˜…è®¡åˆ’ | 4.1 |
| ä¼šå‘˜çŠ¶æ€å¡ç‰‡ | æ˜¾ç¤ºå½“å‰ä¼šå‘˜ç­‰çº§å’Œè¿‡æœŸæ—¶é—´ | 4.8 |
| è®¡åˆ’é€‰æ‹© | ç‚¹å‡»è®¡åˆ’å¡ç‰‡æ‰“å¼€æ”¯ä»˜æ¨¡æ€æ¡† | 4.1 |
| åŠŸèƒ½å¯¹æ¯”è¡¨ | å±•ç¤ºä¸åŒä¼šå‘˜ç­‰çº§çš„åŠŸèƒ½å·®å¼‚ | 4.8 |
| æ”¯ä»˜æˆåŠŸåˆ·æ–° | æ”¯ä»˜æˆåŠŸåè‡ªåŠ¨åˆ·æ–°ç”¨æˆ·ä¿¡æ¯ | 4.5 |

**å­ç»„ä»¶ï¼š**

| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| `MembershipStatusCard` | ä¼šå‘˜çŠ¶æ€å¡ç‰‡ï¼Œæ˜¾ç¤ºå½“å‰ç­‰çº§å’Œè¿‡æœŸæ—¶é—´ |
| `PlanCard` | è®¡åˆ’å¡ç‰‡ï¼Œæ˜¾ç¤ºè®¡åˆ’è¯¦æƒ…å’Œé€‰æ‹©æŒ‰é’® |
| `FeatureComparisonTable` | åŠŸèƒ½å¯¹æ¯”è¡¨ï¼Œå±•ç¤ºå„ç­‰çº§åŠŸèƒ½å·®å¼‚ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```typescript
// åœ¨ App.tsx ä¸­é…ç½®è·¯ç”±
import { SubscriptionPage } from './pages';

<Route path="/subscription" element={
  <ProtectedRoute>
    <SubscriptionPage />
  </ProtectedRoute>
} />
```

## ç»„ä»¶

### PaymentModal (`src/components/PaymentModal.tsx`)

æ”¯ä»˜æ¨¡æ€æ¡†ç»„ä»¶ï¼Œå¤„ç†æ”¯ä»˜æ–¹å¼é€‰æ‹©ã€è®¢å•åˆ›å»ºå’Œæ”¯ä»˜çŠ¶æ€è½®è¯¢ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

| åŠŸèƒ½ | è¯´æ˜ | ç›¸å…³éœ€æ±‚ |
|------|------|----------|
| æ”¯ä»˜æ–¹å¼é€‰æ‹© | æ”¯æŒæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ã€é“¶è”æ”¯ä»˜ | 4.2, 4.3, 4.4 |
| è®¢å•åˆ›å»º | è°ƒç”¨ API åˆ›å»ºæ”¯ä»˜è®¢å• | 4.1 |
| äºŒç»´ç å±•ç¤º | æ˜¾ç¤ºæ”¯ä»˜äºŒç»´ç æˆ–è·³è½¬é“¾æ¥ | 4.2, 4.3 |
| çŠ¶æ€è½®è¯¢ | æ¯ 3 ç§’è½®è¯¢æ”¯ä»˜çŠ¶æ€ | 4.9 |
| è¶…æ—¶å¤„ç† | 5 åˆ†é’Ÿè¶…æ—¶è‡ªåŠ¨åœæ­¢è½®è¯¢ | 4.9 |
| å€’è®¡æ—¶æ˜¾ç¤º | æ˜¾ç¤ºè®¢å•å‰©ä½™æœ‰æ•ˆæ—¶é—´ | 4.9 |

**Propsï¼š**

| å±æ€§ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `isOpen` | boolean | æ˜¯ | æ˜¯å¦æ˜¾ç¤ºæ¨¡æ€æ¡† |
| `plan` | PlanResponse | æ˜¯ | é€‰ä¸­çš„è®¢é˜…è®¡åˆ’ |
| `onClose` | () => void | æ˜¯ | å…³é—­å›è°ƒ |
| `onSuccess` | () => void | æ˜¯ | æ”¯ä»˜æˆåŠŸå›è°ƒ |

**å­ç»„ä»¶ï¼š**

| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| `PaymentMethodSelector` | æ”¯ä»˜æ–¹å¼é€‰æ‹©å™¨ |
| `PaymentInfo` | æ”¯ä»˜ä¿¡æ¯å±•ç¤ºï¼ˆäºŒç»´ç ã€çŠ¶æ€ç­‰ï¼‰ |
| `QRCodeDisplay` | äºŒç»´ç æ˜¾ç¤ºç»„ä»¶ |
| `CountdownTimer` | å€’è®¡æ—¶ç»„ä»¶ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```typescript
import { PaymentModal } from './components';

function MyComponent() {
  const [isOpen, setIsOpen] = useState(false);
  const [selectedPlan, setSelectedPlan] = useState<PlanResponse | null>(null);

  return (
    <>
      <button onClick={() => setIsOpen(true)}>é€‰æ‹©è®¡åˆ’</button>
      {selectedPlan && (
        <PaymentModal
          isOpen={isOpen}
          plan={selectedPlan}
          onClose={() => setIsOpen(false)}
          onSuccess={() => {
            console.log('æ”¯ä»˜æˆåŠŸ');
            setIsOpen(false);
          }}
        />
      )}
    </>
  );
}
```

## çŠ¶æ€ç®¡ç†

### AuthStore (`src/stores/authStore.ts`)

åŸºäº Zustand çš„è®¤è¯çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒæŒä¹…åŒ–å­˜å‚¨ã€‚

**çŠ¶æ€å­—æ®µï¼š**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `user` | `User \| null` | å½“å‰ç™»å½•ç”¨æˆ· |
| `accessToken` | `string \| null` | JWT Access Token |
| `refreshToken` | `string \| null` | JWT Refresh Token |
| `isAuthenticated` | `boolean` | æ˜¯å¦å·²è®¤è¯ |
| `isLoading` | `boolean` | æ˜¯å¦æ­£åœ¨åŠ è½½ |

**æ–¹æ³•ï¼š**

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `setAuth(user, accessToken, refreshToken)` | è®¾ç½®è®¤è¯çŠ¶æ€ |
| `clearAuth()` | æ¸…é™¤è®¤è¯çŠ¶æ€ï¼ˆç™»å‡ºï¼‰ |
| `setLoading(loading)` | è®¾ç½®åŠ è½½çŠ¶æ€ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```typescript
import { useAuthStore } from './stores/authStore';

function MyComponent() {
  const { user, isAuthenticated, setAuth, clearAuth } = useAuthStore();

  // ç™»å½•åè®¾ç½®è®¤è¯çŠ¶æ€
  const handleLogin = async () => {
    const response = await apiService.loginWithEmail(email, password);
    setAuth(response.user, response.tokens.access_token, response.tokens.refresh_token);
  };

  // ç™»å‡º
  const handleLogout = () => {
    clearAuth();
  };

  return (
    <div>
      {isAuthenticated ? (
        <p>æ¬¢è¿, {user?.email || user?.phone}</p>
      ) : (
        <p>è¯·ç™»å½•</p>
      )}
    </div>
  );
}
```
